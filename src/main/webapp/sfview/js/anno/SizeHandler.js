import Handler from"/sfview/js/anno/Handler.js";import Rectangle from"/sfview/js/anno/Rectangle.js";import Anno from"/sfview/js/anno/Anno.js";export default class SizeHandler extends Handler{sx;sy;sw;sh;stepFunc;constructor(cursor,getPosition,stepFunc){super(cursor,getPosition);this.stepFunc=stepFunc}draw(ctx,shape){let[x,y]=this.getPosition(shape);ctx.rect(x,y,Handler.WIDTH,Handler.WIDTH)}getCursor(){return this.cursor+"-resize"}calcStep(shape,x,y){const[ox,oy]=[shape.midX,shape.midY];const[rx,ry]=Rectangle.rotatePoint(x,y,ox,oy,shape.angle);[this.sx,this.sy,this.sw,this.sh]=this.stepFunc(shape,x,y,rx,ry);const[cx,cy,cw,ch]=[shape.x+this.sx,shape.y+this.sy,shape.width+this.sw,shape.height+this.sh];let[bx,by]=Rectangle.rotatePoint(cx,cy,ox,oy,-shape.angle);let[px,py]=Rectangle.rotatePoint(cx+cw/2,cy+ch/2,ox,oy,-shape.angle);let[tx,ty]=Rectangle.rotatePoint(bx,by,px,py,shape.angle);[this.sx,this.sy]=[this.sx+tx-cx,this.sy+ty-cy]}applyStep(shape){shape.shapeStep(this.sx,this.sy,this.sw,this.sh)}endStep(){Anno.shapes.forEachSelected((function(shape){shape.normalize()}))}}