import Tracker from"/sfview/js/anno/Tracker.js";import Handler from"/sfview/js/anno/Handler.js";import SizeHandler from"/sfview/js/anno/SizeHandler.js";import RotateHandler from"/sfview/js/anno/RotateHandler.js";import MoveHandler from"/sfview/js/anno/MoveHandler.js";export default class RectTracker extends Tracker{handlers=[new SizeHandler("nw",(shape=>[shape.x-Handler.WIDTH/2,shape.y-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[rx-shape.x,ry-shape.y,shape.x-rx,shape.y-ry])),new SizeHandler("n",(shape=>[shape.midX-Handler.WIDTH/2,shape.y-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[0,ry-shape.y,0,shape.y-ry])),new SizeHandler("ne",(shape=>[shape.endX-Handler.WIDTH/2,shape.y-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[0,ry-shape.y,rx-shape.endX,shape.y-ry])),new SizeHandler("w",(shape=>[shape.x-Handler.WIDTH/2,shape.midY-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[rx-shape.x,0,shape.x-rx,0])),new SizeHandler("e",(shape=>[shape.endX-Handler.WIDTH/2,shape.midY-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[0,0,rx-shape.endX,0])),new SizeHandler("sw",(shape=>[shape.x-Handler.WIDTH/2,shape.endY-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[rx-shape.x,0,shape.x-rx,ry-shape.endY])),new SizeHandler("s",(shape=>[shape.midX-Handler.WIDTH/2,shape.endY-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[0,0,0,ry-shape.endY])),this.creatingHandler=new SizeHandler("se",(shape=>[shape.endX-Handler.WIDTH/2,shape.endY-Handler.WIDTH/2]),((shape,x,y,rx,ry)=>[0,0,rx-shape.endX,ry-shape.endY])),new RotateHandler((shape=>[shape.midX,shape.y-Handler.WIDTH/2-5*Handler.WIDTH])),new MoveHandler];draw(ctx,shape){super.draw(ctx,shape);ctx.beginPath();ctx.setLineDash([2,2]);let n=shape.y-Handler.WIDTH/2;ctx.moveTo(shape.midX,n);ctx.lineTo(shape.midX,n-4.5*Handler.WIDTH);ctx.stroke()}getHandler(shape,x,y){const handlers=this.handlers;const[rx,ry]=shape.rotatePoint(x,y);for(let i=shape.selected?0:handlers.length-1;i<handlers.length;i++){if(handlers[i].contains(shape,rx,ry)){Handler.shape=shape;return handlers[i]}}return null}}